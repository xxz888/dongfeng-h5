(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fdb744d2"],{"08ea":function(e,t,a){"use strict";var i=a("ba0b"),o=a.n(i);o.a},"9bb8":function(e,t,a){"use strict";a.r(t);var i,o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("van-nav-bar",{attrs:{title:"推广二维码",fixed:""}}),i("div",{staticClass:"zhanwei"}),i("div",{staticClass:"shareImg"},[e.showImg?e._e():i("img",{attrs:{src:e.canvasImg,alt:""},on:{click:function(t){return e.dol()}}}),e.showImg?i("img",{staticClass:"beijing",attrs:{src:a("dcb0"),alt:""}}):e._e(),e.showImg?i("div",{staticStyle:{width:"200px",height:"240px","background-color":"white","margin-top":"20px"},attrs:{id:"qrcode"}}):e._e(),i("img",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"canvaslogo",attrs:{src:a("cf05")}}),i("img",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"toplogo",attrs:{src:a("1bb2")}})]),i("tabbar")],1)},n=[],r=a("bd86"),s=(a("7f7f"),a("da02"),a("6b41")),c=a("8c8e"),l=a("d044"),g=a.n(l),d=a("26fc"),m={name:"sharePage",data:function(){return{showImg:!0,regUrl:"",canvasImg:"",firstCanvas:!0,phone:"",cfg:this.global.configType}},components:(i={},Object(r["a"])(i,s["a"].name,s["a"]),Object(r["a"])(i,"tabbar",d["a"]),i),created:function(){this.phone=localStorage.getItem("phone"),this.getBrand()},beforeRouteEnter:function(e,t,a){sessionStorage.setItem("routerFrom",t.name),a()},methods:{onClickLeft:function(){window.history.back()},dol:function(){var e=document.createElement("a");e.download="推广二维码.png",e.href=this.canvasImg,e.click()},getBrand:function(){var e=this;Object(c["b"])(this.global.brandId).then((function(t){"000000"==t.resp_code?(e.regUrl=t.result.shareMainAddress+"?phone="+e.phone+"&brand_id="+e.global.brandId+"&ip="+e.global.ip,e.getCanvas()):e.$toast({message:resp_message,position:"bottom"})}))},getPixelRatio:function(e){var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/t},getCanvas:function(){var e=this;1==this.showImg&&(this.$store.commit("Loading"),this.$nextTick((function(){document.querySelector(".shareImg").style;var t=document.querySelector(".shareImg").clientWidth,a=(new g.a("qrcode",{width:200,height:240,text:e.regUrl}),t/750),i=1334*a,o=1e3,n=localStorage.getItem("onLogin");n&&(o=100),setTimeout((function(){e.$store.commit("closeLoading");var o=document.querySelector(".beijing"),n=document.querySelector("#qrcode img"),r=document.createElement("canvas"),s=r.getContext("2d"),c=e.getPixelRatio(s);if(r.width=t*c,r.height=i*c,null==document.querySelector("#qrcode img").getAttribute("src")){document.querySelector("#qrcode img").style.visibility="visible",document.querySelector("#qrcode canvas").style.visibility="hidden";var l=document.querySelector("#qrcode canvas"),g=l.toDataURL("image/png");document.querySelector("#qrcode img").setAttribute("src",g)}s.fillStyle="#FFF",s.fillRect(0,0,r.width,r.height);var d=6,m=256*a+d,u=970*a+d,h=240*a-2*d,b=240*a-2*d;s.drawImage(o,0,0,parseInt(r.width),parseInt(r.height)),s.drawImage(n,m*c,u*c,parseInt(h)*c,parseInt(b)*c);var v=document.querySelector(".canvaslogo"),f=parseInt(h)/4,w=parseInt(b)/4,p=m+h/2-f/2,I=u+b/2-w/2;s.drawImage(v,p*c,I*c,f*c,w*c);var x=316*a*c,S=80*a*c,y=118*a*c,q=117*a*c,k=document.querySelector(".toplogo");s.drawImage(k,x,S,y,q);var R=r.width/2,C=1240*a*c;s.fillStyle="#fff",s.textAlign="center",s.font=14*c+"px bold sans-serif",s.fillText("推荐人:"+e.phone.substr(0,3)+"****"+e.phone.substr(7),R,C);var P=r.toDataURL("image/png");e.showImg=!1,e.$nextTick((function(){e.canvasImg=P})),!0===e.firstCanvas&&(e.firstCanvas=!1,s.clearRect(0,0,r.width,r.height),e.showImg=!0,e.getCanvas())}),o)})))}}},u=m,h=(a("08ea"),a("2877")),b=Object(h["a"])(u,o,n,!1,null,"d71b01c6",null);t["default"]=b.exports},ba0b:function(e,t,a){}}]);