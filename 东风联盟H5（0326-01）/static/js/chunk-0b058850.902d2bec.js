(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b058850"],{"1cf0":function(t,a,e){"use strict";e.d(a,"f",(function(){return r})),e.d(a,"i",(function(){return c})),e.d(a,"d",(function(){return o})),e.d(a,"e",(function(){return l})),e.d(a,"c",(function(){return u})),e.d(a,"a",(function(){return p})),e.d(a,"g",(function(){return m})),e.d(a,"h",(function(){return d})),e.d(a,"b",(function(){return _})),e.d(a,"j",(function(){return f}));var s=e("b775"),n=e("4328"),i=e.n(n);function r(t){return Object(s["a"])({url:"/creditcardmanager/app/get/creditcard/by/userid/new",method:"post",params:t})}function c(t,a,e,n){return Object(s["a"])({url:"/user/app/bank/query/byuseridandtype/andnature",method:"post",data:i.a.stringify({userId:t,type:a,nature:e,isDefault:n})})}function o(){return Object(s["a"])({url:"/user/app/bank/get/bankpicture",method:"get"})}function l(t,a){return Object(s["a"])({url:"/user/app/bank/default/"+t,method:"post",data:i.a.stringify({cardno:a})})}function u(t,a,e){return Object(s["a"])({url:"/user/app/bank/del/"+t,method:"post",data:i.a.stringify({cardno:a,type:e})})}function p(t,a,e,n,r,c,o,l,u,p,m,d,_){return Object(s["a"])({url:"/user/app/bank/add/"+t,method:"post",data:i.a.stringify({realname:a,bankcard:e,idcard:n,mobile:r,type:c,expiretime:o,securitycode:l,billDay:u,repaymentDay:p,creditBlance:m,province:d,city:_})})}function m(t,a,e,n){return Object(s["a"])({url:"/user/app/bank/set/bankinfo/province/city",method:"post",data:i.a.stringify({userId:t,bankCardNumber:a,province:e,city:n})})}function d(t,a,e,n,r,c,o){return Object(s["a"])({url:"/user/app/bank/set/bankinfo",method:"post",data:i.a.stringify({userId:t,bankCardNumber:a,securityCode:e,expiredTime:n,billDay:r,repaymentDay:c,creditBlance:o})})}function _(t){return Object(s["a"])({url:"/paymentchannel/app/auth/bankcardocr",method:"post",data:t})}function f(){return Object(s["a"])({url:"/paymentgateway/app/withdraw/config",method:"post"})}},"26f1":function(t,a,e){"use strict";e.d(a,"h",(function(){return r})),e.d(a,"e",(function(){return c})),e.d(a,"a",(function(){return o})),e.d(a,"b",(function(){return l})),e.d(a,"c",(function(){return u})),e.d(a,"d",(function(){return p})),e.d(a,"f",(function(){return m})),e.d(a,"g",(function(){return d}));var s=e("b775"),n=e("4328"),i=e.n(n);function r(){return Object(s["a"])({url:"/creditcardmanager/app/empty/card/get/channel/all",method:"post"})}function c(t,a,e){return Object(s["a"])({url:"/creditcardmanager/app/empty/card/verify/card",method:"post",data:i.a.stringify({userId:t,creditCardNumber:a,version:e})})}function o(t,a,e,n,r,c){return Object(s["a"])({url:"/creditcardmanager/app/empty/card/calculate/reservedamount",method:"post",data:i.a.stringify({userId:t,creditCardNumber:a,amount:e,executeDate:n,version:r,dayRepaymentCounts:c})})}function l(t){return Object(s["a"])({url:"/creditcardmanager/app/empty/card/plan/error/message",method:"post",data:i.a.stringify({planItemId:t})})}function u(t){return Object(s["a"])({url:"/creditcardmanager/app/empty/card/plan/get",method:"post",data:i.a.stringify({planId:t})})}function p(t,a,e,n,r,c){return Object(s["a"])({url:"creditcardmanager/app/empty/card/plan/apply",method:"post",data:i.a.stringify({userId:t,creditCardNumber:a,taskAmount:e,version:n,dayRepaymentCounts:r,city:c})})}function m(t,a){return Object(s["a"])({url:"creditcardmanager/app/empty/card/plan/reRun",method:"post",data:i.a.stringify({userId:t,planId:a})})}function d(t,a){return Object(s["a"])({url:"creditcardmanager/app/empty/card/plan/stop",method:"post",data:i.a.stringify({userId:t,planId:a})})}},"2ae6":function(t,a,e){},"4fca":function(t,a,e){"use strict";var s=e("2ae6"),n=e.n(s);n.a},"7caf":function(t,a,e){"use strict";e.r(a);var s,n=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",[s("van-nav-bar",{attrs:{title:t.task.id?"计划详情":"计划预览","left-arrow":""},on:{"click-left":t.onClickLeft}}),s("div",{staticClass:"warpper"},[s("div",{staticClass:"submit_plan_box"},[s("div",{staticClass:"card_item_sub"},[s("div",{staticClass:"card_item_top "},[s("van-row",{staticClass:"card_item_top",attrs:{type:"flex",justify:"space-between"}},[s("van-col",{attrs:{span:"3"}},[s("div",{staticClass:"card_icon_box"},[s("img",{staticClass:"card_icon",attrs:{src:e("af39")("./BANK_"+t.item.logimg+".png")}})])]),s("van-col",{staticClass:"card_bank",attrs:{span:"20"}},[s("div",{staticClass:"  van-ellipsis"},[t._v("\n                "+t._s(t.item.bankName)+"  \n                "),t.item.cardNo?s("span",[t._v("("+t._s(t._f("cardNoEnd")(t.item.cardNo))+")")]):s("span",[t._v("("+t._s(t._f("cardNoEnd")(t.item.creditCardNumber))+")")])]),s("div",{staticClass:"card_type "},[t._v("\n                账单日 每月"+t._s(t.card.billDay)+"日｜还款日 每月"+t._s(t.card.repaymentDay)+"日\n              ")])])],1)],1)]),s("div",{staticClass:"submit_plan_dec_box"},[s("van-row",{attrs:{type:"flex"}},[s("van-col",{staticClass:"submit_plan_dec",attrs:{span:"12"}},[s("span",{staticClass:"submit_plan_dec_title color_999"},[t._v("还款总次数：")]),s("span",{staticClass:"submit_plan_dec_cont"},[t._v(t._s(Number(t.task.taskCount))+"次")])]),s("van-col",{staticClass:"submit_plan_dec",attrs:{span:"12"}},[s("span",{staticClass:"submit_plan_dec_title color_999"},[t._v("已还次数：")]),s("span",{staticClass:"submit_plan_dec_cont"},[t._v(t._s(t.task.completedCount)+"次")])])],1),s("van-row",{attrs:{type:"flex"}},[s("van-col",{staticClass:"submit_plan_dec",attrs:{span:"12"}},[s("span",{staticClass:"submit_plan_dec_title color_999"},[t._v("还款总金额：")]),s("span",{staticClass:"submit_plan_dec_cont"},[t._v(t._s(t._f("toFixed")(Number(t.task.taskAmount)))+"元")])]),s("van-col",{staticClass:"submit_plan_dec",attrs:{span:"12"}},[s("span",{staticClass:"submit_plan_dec_title color_999"},[t._v("已还金额：")]),s("span",{staticClass:"submit_plan_dec_cont"},[t._v(t._s(t._f("toFixed")(Number(t.task.repaymentedAmount)))+"元")])])],1),s("van-row",{attrs:{type:"flex"}},[s("van-col",{staticClass:"submit_plan_dec",attrs:{span:"12"}},[s("span",{staticClass:"submit_plan_dec_title color_999"},[t._v("预计手续费：")]),s("span",{staticClass:"submit_plan_dec_cont"},[t._v(t._s(t._f("toFixed")(Number(t.task.totalServiceCharge)))+"元")])]),s("van-col",{staticClass:"submit_plan_dec",attrs:{span:"12"}},[s("span",{staticClass:"submit_plan_dec_title color_999"},[t._v("已扣手续费：")]),s("span",{staticClass:"submit_plan_dec_cont"},[t._v(t._s(t._f("toFixed")(t.task.usedServiceCharge))+"元")])])],1),s("van-row",{attrs:{type:"flex"}},[s("van-col",{staticClass:"submit_plan_dec",attrs:{span:"12"}},[s("span",{staticClass:"submit_plan_dec_title color_999"},[t._v("预计返现：")]),s("span",{staticClass:"submit_plan_dec_cont"},[t._v(t._s(t._f("toFixed")(Number(t.task.cashBacking)))+"元")])]),s("van-col",{staticClass:"submit_plan_dec",attrs:{span:"12"}},[s("span",{staticClass:"submit_plan_dec_title color_999"},[t._v("已经返现：")]),s("span",{staticClass:"submit_plan_dec_cont"},[t._v(t._s(t._f("toFixed")(t.task.cashBacked))+"元")])])],1)],1),t.task.id?s("ul",{staticClass:"plan_list"},[t._m(1),t._l(t.task.balancePlanItemList,(function(a){return s("li",{key:a.key,staticClass:"plan_item",on:{click:function(e){return t.taskDetail(a,e)}}},[2==a.type?s("div",{staticClass:"repayment_status"},[s("div")]):t._e(),s("ul",{staticClass:"plan_item_box"},[s("li",{staticClass:"plan_item_item time tiem"},[t._v("\n              "+t._s(a.executeTime)+"\n            ")]),s("li",{staticClass:"plan_item_item type"},[t._v("\n              "+t._s(a.description)+"\n            ")]),s("li",{staticClass:"plan_item_item amount"},[2==a.type?s("span",[t._v("+")]):s("span",[t._v("-")]),t._v(t._s(t._f("toFixed")(Number(a.amount)))+"\n            ")]),s("li"),s("li",{staticClass:"plan_item_item  consumeType  ",class:"plan_task_"+t.taskStatusType(a).split("-")[1]},[t._v("\n              "+t._s(t.taskStatusType(a).split("-")[0])+"\n            ")])])])}))],2):s("ul",{staticClass:"plan_list"},[t._m(0),t._l(t.task.balancePlanItemList,(function(a){return s("li",{key:a.key,staticClass:"plan_item"},[2==a.type?s("div",{staticClass:"repayment_status"},[s("div")]):t._e(),s("ul",{staticClass:"plan_item_box"},[s("li",{staticClass:"plan_item_item time tiem"},[t._v("\n              "+t._s(a.executeTime)+"\n            ")]),s("li",{staticClass:"plan_item_item type"},[t._v("\n              "+t._s(a.description)+"\n            ")]),s("li",{staticClass:"plan_item_item amount"},[2==a.type?s("span",[t._v("+")]):s("span",[t._v("-")]),t._v(t._s(t._f("toFixed")(Number(a.amount)))+"\n            ")])])])}))],2),!t.task.id||5!=t.task.status&&6!=t.task.status&&3!=t.task.status?s("div",{staticClass:"executeplan_btn "},[t.task.id?5!=t.task.status&&6!=t.task.status&&3!=t.task.status?s("div",{staticClass:"confirmplan_btn two theme_btn",on:{click:function(a){return t.endplanMod()}}},[t._v("终止计划\n        ")]):t._e():s("div",{staticClass:"confirmplan_btn two theme_btn",on:{click:function(a){return t.isuserable()}}},[t._v("启动计划")])]):t._e()])]),t.taskDetailTrueFalseBy?s("div",{staticClass:"task_detail_box"},[s("div",{staticClass:"task_detail"},[s("div",{staticClass:"task_detail_title"},[s("span",[t._v(t._s(t._f("taskDetailTypeNew")(t.taskDetailItem.type)))]),t._v("明细\n      ")]),s("div",{staticClass:"task_detail_cont"},[s("div",{staticClass:"task_detail_cont_top"},[s("van-row",{staticClass:"task_detail_item",attrs:{type:"flex"}},[0!=t.taskDetailItem.orderCode?s("van-col",[s("div",[t._v("订单号：\n                "),s("span",[t._v(t._s(t.taskDetailItem.orderCode))])])]):t._e()],1),s("van-row",{staticClass:"task_detail_item",attrs:{type:"flex"}},[s("van-col",{attrs:{span:"14"}},[s("div",[t._v("计划金额："),s("span",{staticClass:"task_detail_item_right"},[t._v(t._s(t.taskDetailItem.amount))])])]),s("van-col",{attrs:{span:"14"}},[2==t.taskDetailItem.type?s("span",[t._v("扣款金额：")]):s("span",[t._v("还款金额：")]),s("span",{staticClass:"task_detail_item_right"},[t._v(t._s(t.taskDetailItem.amount))])])],1),s("van-row",{staticClass:"task_detail_item",attrs:{type:"flex"}},[s("van-col",{attrs:{span:"14"}},[s("div",[t._v("计划手续费："),s("span",{staticClass:"task_detail_item_right"},[t._v(t._s(t.taskDetailItem.serviceCharge))])])]),s("van-col",{attrs:{span:"14"}},[s("div",[t._v("计划费率："),s("span",{staticClass:"task_detail_item_right"},[t._v(t._s(t.handleRate()))])])])],1),s("van-row",{staticClass:"task_detail_item",attrs:{type:"flex"}},[s("van-col",{attrs:{span:"14"}},[s("div",[t._v("计划类型："),s("span",{staticClass:"task_detail_item_right"},[t._v(t._s(t.taskDetailItem.description)+" ")])])]),s("van-col",{attrs:{span:"14"}},[s("div",[t._v("计划状态：\n                "),2==t.taskDetailItem.status?s("span",{staticClass:"plan_task_success"},[t._v("执行中")]):t._e(),1==t.taskDetailItem.status?s("span",{staticClass:"plan_task_await"},[t._v("待执行")]):t._e(),3==t.taskDetailItem.status?s("span",{staticClass:"plan_task_success"},[t._v("已成功")]):t._e(),5==t.taskDetailItem.status?s("span",{staticClass:"plan_task_await"},[t._v("已取消")]):t._e(),4==t.taskDetailItem.status?s("span",{staticClass:"plan_task_error"},[t._v("已失败")]):t._e()])])],1)],1),s("div",{staticClass:"task_detail_cont_top"},[s("van-row",{staticClass:"task_detail_item",attrs:{type:"flex"}},[s("van-col",[4==t.taskDetailItem.status?s("div",[t._v("失败原因：\n                "),t.taskDetailItem.message?s("span",{staticClass:"plan_task_error"},[t._v(t._s(t.taskDetailItem.message))]):s("span",{staticClass:"plan_task_error"},[t._v(t._s(t.task.message))])]):s("div",[t._v("计划描述："+t._s(t.taskDetailItem.city))])])],1),s("van-row",{staticClass:"task_detail_item",attrs:{type:"flex"}},[s("van-col",[s("div",[t._v("计划执行时间："+t._s(t.taskDetailItem.executeTime))])])],1)],1)]),s("div",{staticClass:"task_detail_close_box",on:{click:function(a){t.taskDetailTrueFalseBy=!1}}},[s("div",{staticClass:"task_detail_close"})])])]):t._e(),s("van-popup",{style:{height:"45%"},attrs:{position:"bottom"},model:{value:t.show,callback:function(a){t.show=a},expression:"show"}},[s("van-picker",{attrs:{"show-toolbar":"",title:"落地商户",columns:t.columns,"default-index":t.defConsumeType},on:{cancel:function(a){t.showPicker=!1},confirm:t.consumeTypeConfirm,change:t.onChange}})],1),s("is-password",{ref:"isPassword",on:{confirmPlan:t.confirmPlan}}),s("confirmorcancel",{ref:"causeMessage",attrs:{src:"../../assets/alert.png",but:"3",zi:t.start}})],1)},i=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("li",{staticClass:"plan_title"},[e("ul",{staticClass:"plan_item_box"},[e("li",{staticClass:"plan_item_item time"},[t._v("时间")]),e("li",{staticClass:"plan_item_item type"},[t._v("类型")]),e("li",{staticClass:"plan_item_item amount"},[t._v("金额")])])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("li",{staticClass:"plan_title"},[e("ul",{staticClass:"plan_item_box"},[e("li",{staticClass:"plan_item_item time"},[t._v("时间")]),e("li",{staticClass:"plan_item_item type"},[t._v("类型")]),e("li",{staticClass:"plan_item_item amount"},[t._v("金额")]),e("li",{staticClass:"plan_item_item consumeType"},[t._v("状态")])])])}],r=(e("c5f6"),e("28a5"),e("ac6a"),e("bd86")),c=(e("8e11"),e("f253")),o=(e("87d0"),e("e41f")),l=(e("b342"),e("ad06")),u=(e("47d1"),e("9ffb")),p=(e("4bc8"),e("d1e1")),m=(e("7f7f"),e("da02"),e("6b41")),d=e("bfac"),_=e("1cf0"),f=e("663f"),v=e("58d2"),b=e("26f1"),k=e("b383"),h={data:function(){return{userId:localStorage.getItem("userId"),planId:"",item:{},task:{},channelactive:[],authorityList:{result:{bankCard:"",bankName:"",channelTag:"",confirmSmsUrl:"",expiredTime:"",getSmsUrl:"",getSmsUrlNew:"",idCard:"",ipAddress:"",phone:"",securityCode:"",userName:""}},orderCode:"",merchantList:[],merchantTrueFalseBy:!1,consumeType:!1,extra:"",show:!1,columns:[],columnsActive:{},defConsumeType:0,start:"",taskDetailTrueFalseBy:!1,taskDetailItem:{},card:{},empowerToken:null}},components:(s={},Object(r["a"])(s,m["a"].name,m["a"]),Object(r["a"])(s,p["a"].name,p["a"]),Object(r["a"])(s,u["a"].name,u["a"]),Object(r["a"])(s,"isPassword",f["a"]),Object(r["a"])(s,l["a"].name,l["a"]),Object(r["a"])(s,o["a"].name,o["a"]),Object(r["a"])(s,c["a"].name,c["a"]),Object(r["a"])(s,"confirmorcancel",d["a"]),s),computed:{totalRepaymentAmount:function(){var t=0;return this.task.balancePlanItemList.forEach((function(a){2==a.type&&3==a.status&&(t+=a.amount)})),t}},created:function(){var t=this;this.$route.query.empowerToken?this.empowerToken=this.$route.query.empowerToken:this.empowerToken=null,this.item=JSON.parse(this.$route.params.item),this.task=JSON.parse(this.$route.params.task),this.extra=this.$route.params.extra,k["a"].$on("backFromBindCard",(function(a){1==a&&(k["a"].$emit("backFromBindCard",0),t.confirmPlan())})),this._cardQuery()},methods:{executeDateTime:function(t){var a=t,e=t.split(" ");return a=e[0].split("-")[1]+"-"+e[0].split("-")[2]+" "+e[1].split(":")[0]+":"+e[1].split(":")[1],a},taskStatusType:function(t){var a="";return 1==t.status?a="待执行-await":2==t.status?a="执行中-await":3==t.status?a="已成功-success":4==t.status?a="已失败-error":5==t.status&&(a="已取消-await"),a},onClickLeft:function(){this.publicJs.back()},consumeTypeSplit:function(t){var a=t.consumeType;return t.consumeType.split("(").length>1?a=""==t.consumeType.split("(")[0]?t.consumeType.split("(")[1].split(")")[0]:t.consumeType:t.consumeType.split("-").length>1?a=t.consumeType.split("-")[0]:t.consumeType.split("|").length>1&&(a=t.consumeType.split("|")[1]),a},showConsumeType:function(t){var a=this;this.columnsActive=t,this.merchantList.forEach((function(e,s){e.value!=t.consumeType||(a.defConsumeType=s)})),this.show=!0},onChange:function(t,a){this.columnsActive.consumeType=a.value},consumeTypeConfirm:function(t,a){this.columnsActive.consumeType=t.value,this.show=!1},isPassword:function(){var t=this.global.dontPayPawBrandid.indexOf(Number(this.task.brandId));-1==t?this.confirmPlan():this.$refs.isPassword.onshow()},_causeMessage:function(t){var a=this;Object(b["b"])(t.id).then((function(t){t.resp_code,a.start=t.resp_message,a.$refs.causeMessage.disopen()})).catch((function(t){}))},handleRate:function(){return 100*this.task.rate+"%"},isuserable:function(){var t=this,a=this.task.balancePlanItemList[this.task.balancePlanItemList.length-1].executeTime,e=new Date,s=e.getDate();s>this.task.repaymentDay&&e.setMonth(e.getMonth()+1);var n=e.getFullYear(),i=e.getMonth()+1;i=i<10?"0"+i:""+i;s=this.task.repaymentDay<10?"0"+this.task.repaymentDay:""+this.task.repaymentDay;a.slice(0,10)>n+"-"+i+"-"+s?this.$dialog.confirm({title:"温馨提示",message:"还款计划的最后执行时间超过了银行卡的还款日，确定要继续吗？",confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){t.verifyBindCard()})).catch((function(){})):this.verifyBindCard()},verifyBindCard:function(){var t=this;this.$store.commit("Loading"),Object(v["b"])({userId:this.userId,creditCardNumber:this.task.creditCardNumber,empowerToken:this.empowerToken}).then((function(a){t.$store.commit("closeLoading"),"000000"==a.resp_code?t.confirmPlan():"999992"==a.resp_code&&(sessionStorage.setItem("params",JSON.stringify({userId:t.userId,creditCardNumber:t.item.cardNo,empowerToken:t.empowerToken})),sessionStorage.setItem("card",JSON.stringify(t.item)),t.$router.push("/TiedCard"))})).catch((function(a){t.$store.commit("closeLoading"),t.$toast({message:"计划启动失败",position:"bottom"})}))},confirmPlan:function(){var t=this;this.$store.commit("Loading"),Object(v["a"])({userId:this.userId,creditCardNumber:this.task.creditCardNumber,empowerToken:this.empowerToken}).then((function(a){t.$store.commit("closeLoading"),"000000"==a.resp_code&&(t.empowerToken&&k["a"].$emit("empowerToken",t.empowerToken),t.$toast({message:"计划启动成功",position:"bottom"}),history.go(-2))})).catch((function(a){t.$store.commit("closeLoading"),t.$toast({message:"计划启动失败",position:"bottom"})}))},taskDetail:function(t,a){a.cancelBubble=!0,this.taskDetailTrueFalseBy=!0,this.taskDetailItem=t},endplanMod:function(){var t=this;this.$store.commit("Loading"),Object(v["l"])({planId:this.task.id,empowerToken:this.empowerToken}).then((function(a){t.$store.commit("closeLoading"),"000000"==a.resp_code&&(t.empowerToken&&k["a"].$emit("empowerToken",t.empowerToken),t.$toast({message:"计划取消成功",position:"bottom"}),history.go(-1))})).catch((function(a){t.$store.commit("closeLoading"),t.$toast({message:"计划取消失败",position:"bottom"})}))},_cardQuery:function(){var t=this;Object(_["f"])({token:this.empowerToken}).then((function(a){"000000"==a.resp_code&&a.result.forEach((function(a){a.cardNo==t.task.creditCardNumber&&(t.card=a)}))}))}}},y=h,C=(e("4fca"),e("2877")),g=Object(C["a"])(y,n,i,!1,null,"6dc9e7fd",null);a["default"]=g.exports},b383:function(t,a,e){"use strict";var s=e("2b0e"),n=new s["a"]({});a["a"]=n}}]);